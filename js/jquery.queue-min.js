/*
 * @author          Designcise
 * 
 * @license         This file is a commercial file, which is available for purchase from  
 *                  http://www.designcise.com/. Any illegal copying, distribution, packaging 
 *                  or re-production of this file for commercial or personal use is strictly 
 *                  prohibited and will be considered theft. For full terms of license see 
 *                  http://codecanyon.net/licenses/regular_extended.
 *
 * @copyright       The author is the first owner of copyright and reserves all rights to
 *                  all written work contained in this file. Distribution, re-production
 *                  or commercial use of the written work in this file, without the author's
 *                  signed permission, prior consent or a valid license, is strictly prohibited.
 *                  The author is protected by the "Copyright, Designs and Patents Act 1988" of
 *                  the United Kingdom. Any infringement of the copyright, in or outside of the
 *                  United Kingdom, may result in a lawsuit. By using this file, you agree to 
 *                  abide by the terms of the license.
 */



function Queue(l){l=l||Array();var n=this,e=null,m=null,b=true,a=-1,g=0,j=-1,f=false,i={},k=false,d=function(p,o){if(i[p]){i[p].fireWith(n,o)}},c=function(o){return n.baseURL+((o.lastIndexOf("?")!==-1)?o.substr(0,o.lastIndexOf("?")):o)},h=function(q){var p={};if(q.lastIndexOf("?")!==-1){var o=(q.substr(q.lastIndexOf("?")+1)).split("&");$.each(o,function(t,s){var r=s.split("=");p[r[0]]=r[1]})}return p};this.connection={timeout:2000,check:true,url:"http://www.designcise.com/framework/img/chk_conn.gif"},this.timeout=5000,this.baseURL="",this.alwaysSend=null,this.dataType="jsonp",this.cache=false,this.loaderClass="loader",this.type="GET";this.on=function(o,p){if(!i[o]){i[o]=$.Callbacks();i[o].add(p)}return this};this.off=function(o){if(!i[o]){return}delete i[o];return this};this.add=function(q,o,r){r=r||false;if(null==o||(o===l.length&&r)){if(q instanceof Array){for(var p=0;p<q.length;p++){l.push(q[p])}}else{l.push(q)}}else{o-=1;if(q instanceof Array){for(var p=q.length-1;p>=0;p--){l.splice((o+((r)?1:0)),0,q[p])}}else{l.splice((o+((r)?1:0)),0,q)}}return this};this.remove=function(o){if(o>=0&&o>g&&o<l.length){l.splice((o-1),1)}return this};this.showLoader=function(p,o){p=$(p)||$(document.body);o=o||0.65;if(p.css("position")==="static"){p.css("position","relative")}$('<div class="'+n.loaderClass+'"/>').prependTo(p).fadeTo("slow",o);return this};this.hideLoader=function(o){o=(null!=o)?$(o).find("."+n.loaderClass):$("."+n.loaderClass);o.fadeOut("slow","linear",function(){$(this).remove()});return this};this.request=function(u,x,t,p){if(b){if(typeof u==="string"){u={url:u,success:x,error:t,always:p}}f=true;if(null!=n.alwaysSend){var q=$.param(n.alwaysSend);q=q.split("&");for(var r=0;r<q.length;r++){var s=q[r].split("="),w=s[0],v=s[1];if(u.url.indexOf(w+"=")===-1){u.url=u.url+((null!=v)?(((u.url.indexOf("?")!==-1)?"&":"?")+w+"="+v):"")}}}if(u.dataType==="jsonp"||n.dataType==="jsonp"){var o="queueProxy"+(new Date()).getTime();window[o]=function(){return false}}d("processStart",[g+1,c(u.url),h(u.url),l.length,(g===j)]);j=g;m=$.ajax({url:n.baseURL+(u.url||""),dataType:u.dataType||n.dataType,cache:u.cache||n.cache,jsonpCallback:o,type:u.type||n.type,crossDomain:((u.dataType==="jsonp"||n.dataType==="jsonp")?true:false),timeout:u.timeout||n.timeout,error:function(y,A,z){m=null;f=false;g+=1;if(A==="cancel"){A="abort";z="Request Canceled"}else{if(A==="stop"){A="abort";z="Request Stopped"}}if(typeof u.error==="function"){u.error(g,c(u.url),h(u.url),A,z,l.length,k)}if(typeof u.always==="function"){u.always(g,l.length,false,k)}k=false},success:function(z){m=null;var y=k;k=f=(typeof u.success==="function")?(u.success(z,(g+1),c(u.url),h(u.url),l.length,k)||false):false;if(!f){g+=1}if(typeof u.always==="function"){u.always(g,l.length,true,y)}}})}return this};this.cancel=function(o,q){o=o-1;q=(typeof q!=="boolean")?false:q;if(o<l.length){var p=setInterval(function(){if(g<=o){if(null!=m&&g===o){if(q&&!k){return}m.abort("cancel");clearInterval(p);p=null}else{if(a===-1||a<g){if(q&&!k){return}a=o}}}else{clearInterval(p);p=null}},50);setTimeout(function(){if(null!=p){clearInterval(p)}},25000)}return this};this.stop=function(){if(null!=e){clearInterval(e);if(null!=m){m.abort("stop")}var o=k;for(var p=g;p<l.length;p++){if(typeof l[p].error==="function"){l[p].error(p+1,c(l[p].url),h(l[p].url),"abort","Request Stopped",l.length,o)}o=false}for(var p=g;p<l.length;p++){if(typeof l[p].always==="function"){l[p].always(p+1,l.length,false,k)}k=false}d("complete");g=l.length-1}return this};this.start=function(){if(n.isWorking()){n.stop()}a=-1,g=0,j=-1,f=false;d("init");var p=false;if(n.connection.check){var q=document.createElement("img"),r=false;var o=setTimeout(function(){b=r;p=true},n.connection.timeout);q.src=n.connection.url;q.onerror=function(){b=false;p=true;clearTimeout(o)};q.onload=function(){p=r=true;clearTimeout(o)}}e=setInterval(function(){if(n.connection.check&&!p){return false}if(!b){if(null!=e){clearInterval(e)}var s=k;for(var u=g;u<l.length;u++){if(typeof l[u].error==="function"){l[u].error(u+1,window.location.href,"","connection","Error Establishing Connection",l.length,s)}s=false}for(var u=g;u<l.length;u++){if(typeof l[u].always==="function"){l[u].always(u+1,l.length,false,k)}k=false}d("complete")}else{if(g<l.length){if(!f){if(a===g){f=false;g+=1;if(g>l.length){g=l.length}var t=l[g-1].url;if(typeof l[g].error==="function"){l[g].error(g,c(t),h(t),"abort","Request Skipped",l.length,k)}if(typeof l[g].always==="function"){l[g].always(g,l.length,false,k)}k=false}if(g<l.length){n.request(l[g])}}}else{if(g===l.length){if(null!=e){clearInterval(e)}d("complete")}}}},100);return this};this.prop=function(o,q,p){if(null!=p){l[o-1][q]=p;return this}else{return(l[o-1][q]||n[q])}};this.isDone=function(o){return(g>=o)};this.isWorking=function(){return(g>=0&&g<l.length)}};